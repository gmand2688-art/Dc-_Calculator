<!doctype html>
<html lang="el">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Advanced DC Cable & Temp Calculator</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; margin: 20px; max-width: 950px; background-color: #f0f4f8; color: #2c3e50; }
    .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.06); margin-bottom: 20px; }
    h2, h3 { color: #1e40af; margin-top: 0; border-bottom: 2px solid #e5e7eb; padding-bottom: 10px; }
    
    /* Responsive Row */
    .row { 
      display: flex; 
      gap: 15px; 
      flex-wrap: wrap; 
      margin-bottom: 15px; 
      align-items: flex-end; 
    }
    
    .input-group { 
      display: flex; 
      flex-direction: column; 
      flex: 1 1 150px; 
    }

    /* Ειδική κλάση για το πεδίο που έχει το Select */
    .combined-input {
      display: flex;
      gap: 10px;
    }

    label { font-size: 13px; font-weight: bold; margin-bottom: 5px; color: #4b5563; }
    input, select { padding: 12px; border: 1px solid #d1d5db; border-radius: 8px; font-size: 14px; width: 100%; box-sizing: border-box; }
    
    .mode-selector { display: flex; background: #e5e7eb; border-radius: 8px; padding: 5px; margin-bottom: 20px; }
    .mode-btn { flex: 1; padding: 10px; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; transition: 0.3s; }
    .active { background: #2563eb; color: white; }

    .btn-calc { background-color: #2563eb; color: white; width: 100%; font-size: 18px; padding: 15px; border: none; border-radius: 8px; cursor: pointer; margin-top: 15px; }
    .out { font-family: 'Consolas', monospace; white-space: pre-wrap; background: #1e293b; color: #f8fafc; padding: 25px; border-radius: 10px; border-left: 8px solid #2563eb; font-size: 15px; line-height: 1.6; }
    .highlight { color: #60a5fa; font-weight: bold; }
    .safe { color: #4ade80; font-weight: bold; }

    /* Media Query για Κινητά */
    @media (max-width: 600px) {
      body { margin: 10px; }
      .row { flex-direction: column; align-items: stretch; gap: 15px; }
      .input-group { flex: 1 1 100%; }
      .combined-input { gap: 8px; }
      .combined-input select { width: 120px; } /* Μικρότερο πλάτος για το select στο κινητό */
    }
  </style>
</head>
<body>

  <div class="card">
    <h2>⚡ Υπολογισμός DC</h2>
    
    <label>Τι αντιπροσωπεύει η εισαγωγή σου;</label>
    <div class="mode-selector">
      <button id="modeLoad" class="mode-btn active" onclick="setMode('load')">Πραγματική Κατανάλωση</button>
      <button id="modeFuse" class="mode-btn" onclick="setMode('fuse')">Ονομαστική Ασφάλεια</button>
    </div>

    <div class="row">
      <div class="input-group" style="flex: 2;">
        <label id="inputLabel">Τιμή Φορτίου</label>
        <div class="combined-input">
          <input id="inputValue" type="number" value="80" step="any">
          <select id="unitType" style="width: 140px;">
            <option value="A">Amper (A)</option>
            <option value="W">Watt (W)</option>
          </select>
        </div>
      </div>
      
      <div class="input-group">
        <label>Τάση (V)</label>
        <input id="voltageV" type="number" value="48" step="any">
      </div>
      
      <div class="input-group">
        <label>Μήκος l (m)</label>
        <input id="lengthM" type="number" value="15" step="any">
      </div>
    </div>

    <div class="row">
      <div class="input-group">
        <label>Θερμοκρασία Περιβάλλοντος</label>
        <select id="tempAmbient">
          <option value="1.12">10°C (Πολύ κρύο)</option>
          <option value="1.08" selected>20°C (Δροσερό/Εσωτερικό)</option>
          <option value="1.0">30°C (Κανονική)</option>
          <option value="0.91">40°C (Ζέστη)</option>
          <option value="0.82">50°C (Μηχανοστάσιο)</option>
        </select>
      </div>
      <div class="input-group">
        <label>Επιτρεπτή Πτώση (%)</label>
        <input id="vdropPct" type="number" value="4" step="any">
      </div>
    </div>

    <button class="btn-calc" onclick="calculate()">Εκτέλεση Υπολογισμού</button>
  </div>

  <div class="card">
    <h3>Αποτελέσματα Μελέτης</h3>
    <div class="out" id="results">Εισάγετε δεδομένα...</div>
  </div>

<script>
  let currentMode = 'load';

  const WIRE_DB = [
    {s: 0.75, maxI: 6}, {s: 1, maxI: 10}, {s: 1.5, maxI: 15.5}, {s: 2.5, maxI: 21},
    {s: 4, maxI: 28}, {s: 6, maxI: 36}, {s: 10, maxI: 50}, {s: 16, maxI: 68},
    {s: 25, maxI: 89}, {s: 35, maxI: 110}, {s: 50, maxI: 134}, {s: 70, maxI: 171},
    {s: 95, maxI: 207}, {s: 120, maxI: 239}, {s: 150, maxI: 275}, {s: 185, maxI: 314},
    {s: 240, maxI: 370}, {s: 300, maxI: 424}, {s: 400, maxI: 510}
  ];

  const FUSES = [1, 2, 4, 6, 10, 13, 16, 20, 25, 32, 40, 50, 63, 80, 100, 125, 160, 200, 250, 315, 400, 500, 630];

  function setMode(mode) {
    currentMode = mode;
    document.getElementById('modeLoad').classList.toggle('active', mode === 'load');
    document.getElementById('modeFuse').classList.toggle('active', mode === 'fuse');
    document.getElementById('inputLabel').innerText = mode === 'load' ? "Τιμή Κατανάλωσης" : "Τιμή Ασφάλειας";
  }

  function calculate() {
    try {
      const valInput = parseFloat(document.getElementById('inputValue').value);
      const U = parseFloat(document.getElementById('voltageV').value);
      const L = parseFloat(document.getElementById('lengthM').value);
      const dropPct = parseFloat(document.getElementById('vdropPct').value);
      const tempF = parseFloat(document.getElementById('tempAmbient').value);
      const unit = document.getElementById('unitType').value;
      const gamma = 59.5; 

      if (isNaN(valInput) || isNaN(U) || U <= 0) throw new Error("Παρακαλώ εισάγετε έγκυρες τιμές.");

      let I_load;
      if (unit === 'W') {
        I_load = valInput / U;
      } else {
        I_load = valInput;
      }

      let targetLoad, targetFuse;

      if (currentMode === 'load') {
        targetLoad = I_load;
        targetFuse = FUSES.find(f => f >= targetLoad * 1.25) || "N/A";
      } else {
        targetFuse = I_load;
        targetLoad = I_load;
      }

      const maxDropV = U * (dropPct / 100);
      const s_req = (2 * L * targetLoad) / (gamma * maxDropV);

      let wire = WIRE_DB.find(w => w.s >= s_req && (w.maxI * tempF) >= (currentMode === 'load' ? (targetFuse === "N/A" ? targetLoad : targetFuse) : targetFuse));

      if (!wire) throw new Error("Δεν βρέθηκε επαρκές καλώδιο για αυτά τα δεδομένα.");

      const actualDropV = (2 * L * targetLoad) / (gamma * wire.s);
      const actualDropPct = (actualDropV / U) * 100;

      let h = `Mode: ${currentMode === 'load' ? 'ΚΑΤΑΝΑΛΩΣΗ' : 'ΑΣΦΑΛΕΙΑ'} (${unit})\n`;
      h += `------------------------------------------\n`;
      h += `ΣΥΝΟΛΙΚΟ ΦΟΡΤΙΟ:      <span class="highlight">${targetLoad.toFixed(2)} A</span> (${(targetLoad * U).toFixed(1)} W)\n`;
      h += `ΕΠΙΛΕΓΜΕΝΟ ΚΑΛΩΔΙΟ:  <span class="safe">${wire.s} mm²</span>\n`;
      h += `ΟΝΟΜΑΣΤΙΚΗ ΑΣΦΑΛΕΙΑ: <span class="highlight">${targetFuse} A</span>\n`;
      h += `ΑΝΤΟΧΗ ΣΤΟΥΣ ${document.getElementById('tempAmbient').options[document.getElementById('tempAmbient').selectedIndex].text.split(' ')[0]}: ${(wire.maxI * tempF).toFixed(1)} A\n`;
      h += `------------------------------------------\n`;
      h += `ΠΤΩΣΗ ΤΑΣΗΣ:         ${actualDropV.toFixed(2)} V (${actualDropPct.toFixed(2)}%)\n`;
      h += `ΑΠΩΛΕΙΑ ΙΣΧΥΟΣ:      ${(targetLoad * actualDropV).toFixed(1)} Watt\n`;

      document.getElementById('results').innerHTML = h;
    } catch (e) {
      document.getElementById('results').innerHTML = `<span style="color:#f87171;">Σφάλμα: ${e.message}</span>`;
    }
  }
</script>
</body>
</html>
